import r from"fs";import e from"rimraf";import n from"aproba";import o from"copy-concurrently";import t from"run-queue";import a from"util";var u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var i={};i=move;var m=r;var c=e;var f=n;var s=o;var l=t;var v=Object.assign||a._extend;function promisify(r,e){return function(){var n=[].slice.call(arguments);return new r((function(r,o){return e.apply(null,n.concat((function(e,n){e?o(e):r(n)})))}))}}function move(r,e,n){f("SSO|SS",arguments);n=v({},n||{});var o=n.Promise||u.Promise;var t=n.fs||m;var a=promisify(o,c);var i=promisify(o,t.rename);n.top=r;var p=new l({maxConcurrency:n.maxConcurrency,Promise:o});n.queue=p;n.recurseWith=rename;p.add(0,rename,[r,e,n]);return p.run().then((function(){return remove(r)}),(function(r){return"EEXIST"===r.code||"EPERM"===r.code?passThroughError():remove(e).then(passThroughError,passThroughError);function passThroughError(){return o.reject(r)}}));function remove(r){var e={unlink:t.unlink,chmod:t.chmod,stat:t.stat,lstat:t.lstat,rmdir:t.rmdir,readdir:t.readdir,glob:false};return a(r,e)}function rename(r,e,n,t){return i(r,e).catch((function(t){return"EXDEV"!==t.code?o.reject(t):remove(e).then((function(){return s.item(r,e,n)}))}))}}var p=i;export default p;

