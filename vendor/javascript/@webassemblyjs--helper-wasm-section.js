import e from"@webassemblyjs/wasm-gen";import t from"@webassemblyjs/ast";import r from"@webassemblyjs/helper-buffer";import o from"@webassemblyjs/helper-wasm-bytecode";var n={};Object.defineProperty(n,"__esModule",{value:true});n.resizeSectionByteSize=resizeSectionByteSize;n.resizeSectionVecSize=resizeSectionVecSize;var i=e;var a=t;var c=r;function resizeSectionByteSize(e,t,r,o){var n=(0,a.getSectionMetadata)(e,r);if("undefined"===typeof n)throw new Error("Section metadata not found");if("undefined"===typeof n.size.loc)throw new Error("SectionMetadata "+r+" has no loc");var u=n.size.loc.start.column;var f=n.size.loc.end.column;var s=n.size.value+o;var v=(0,i.encodeU32)(s);n.size.value=s;var l=f-u;var d=v.length;if(d!==l){var S=d-l;n.size.loc.end.column=u+d;o+=S;n.vectorOfSize.loc.start.column+=S;n.vectorOfSize.loc.end.column+=S}var m=false;(0,a.traverse)(e,{SectionMetadata:function SectionMetadata(t){t.node.section!==r?true===m&&(0,a.shiftSection)(e,t.node,o):m=true}});return(0,c.overrideBytesInBuffer)(t,u,f,v)}function resizeSectionVecSize(e,t,r,o){var n=(0,a.getSectionMetadata)(e,r);if("undefined"===typeof n)throw new Error("Section metadata not found");if("undefined"===typeof n.vectorOfSize.loc)throw new Error("SectionMetadata "+r+" has no loc");if(-1===n.vectorOfSize.value)return t;var u=n.vectorOfSize.loc.start.column;var f=n.vectorOfSize.loc.end.column;var s=n.vectorOfSize.value+o;var v=(0,i.encodeU32)(s);n.vectorOfSize.value=s;n.vectorOfSize.loc.end.column=u+v.length;return(0,c.overrideBytesInBuffer)(t,u,f,v)}var u={};Object.defineProperty(u,"__esModule",{value:true});u.createEmptySection=createEmptySection;var f=e;var s=r;var v=_interopRequireDefault(o);var l=_interopRequireWildcard(t);function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}t.default=e;return t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return _typeof(e)}function findLastSection(e,t){var r=v.default.sections[t];var o=e.body[0].metadata.sections;var n;var i=0;for(var a=0,c=o.length;a<c;a++){var u=o[a];if("custom"!==u.section){var f=v.default.sections[u.section];if(r>i&&r<f)return n;i=f;n=u}}return n}function createEmptySection(e,t,r){var o=findLastSection(e,r);var n,i;if(null==o||"custom"===o.section){n=8;i=n}else{n=o.startOffset+o.size.value+1;i=n}n+=1;var a={line:-1,column:n};var c={line:-1,column:n+1};var u=l.withLoc(l.numberLiteralFromRaw(1),c,a);var v={line:-1,column:c.column};var d={line:-1,column:c.column+1};var S=l.withLoc(l.numberLiteralFromRaw(0),d,v);var m=l.sectionMetadata(r,n,u,S);var y=(0,f.encodeNode)(m);t=(0,s.overrideBytesInBuffer)(t,n-1,i,y);if("object"===_typeof(e.body[0].metadata)){e.body[0].metadata.sections.push(m);l.sortSectionMetadata(e.body[0])}var p=+y.length;var z=false;l.traverse(e,{SectionMetadata:function SectionMetadata(t){t.node.section!==r?true===z&&l.shiftSection(e,t.node,p):z=true}});return{uint8Buffer:t,sectionMetadata:m}}var d={};Object.defineProperty(d,"__esModule",{value:true});d.removeSections=removeSections;var S=t;var m=r;function removeSections(e,t,r){var o=(0,S.getSectionMetadatas)(e,r);if(0===o.length)throw new Error("Section metadata not found");return o.reverse().reduce((function(t,o){var n=o.startOffset-1;var i="start"===r?o.size.loc.end.column+1:o.startOffset+o.size.value+1;var a=-(i-n);var c=false;(0,S.traverse)(e,{SectionMetadata:function SectionMetadata(t){if(t.node.section===r){c=true;return t.remove()}true===c&&(0,S.shiftSection)(e,t.node,a)}});var u=[];return(0,m.overrideBytesInBuffer)(t,n,i,u)}),t)}var y={};Object.defineProperty(y,"__esModule",{value:true});Object.defineProperty(y,"resizeSectionByteSize",{enumerable:true,get:function get(){return p.resizeSectionByteSize}});Object.defineProperty(y,"resizeSectionVecSize",{enumerable:true,get:function get(){return p.resizeSectionVecSize}});Object.defineProperty(y,"createEmptySection",{enumerable:true,get:function get(){return z.createEmptySection}});Object.defineProperty(y,"removeSections",{enumerable:true,get:function get(){return b.removeSections}});var p=n;var z=u;var b=d;const O=y.__esModule,_=y.resizeSectionByteSize,w=y.resizeSectionVecSize,h=y.createEmptySection,M=y.removeSections;export default y;export{O as __esModule,h as createEmptySection,M as removeSections,_ as resizeSectionByteSize,w as resizeSectionVecSize};

