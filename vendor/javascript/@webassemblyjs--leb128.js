import e from"@xtuc/long";import r from"buffer";var n={};Object.defineProperty(n,"__esModule",{value:true});n.extract=extract;n.inject=inject;n.getSign=getSign;n.highOrder=highOrder;function extract(e,r,n,t){if(n<0||n>32)throw new Error("Bad value for bitLength.");if(void 0===t)t=0;else if(0!==t&&1!==t)throw new Error("Bad value for defaultBit.");var o=255*t;var d=0;var f=r+n;var a=Math.floor(r/8);var u=r%8;var c=Math.floor(f/8);var i=f%8;0!==i&&(d=get(c)&(1<<i)-1);while(c>a){c--;d=d<<8|get(c)}d>>>=u;return d;function get(r){var n=e[r];return void 0===n?o:n}}function inject(e,r,n,t){if(n<0||n>32)throw new Error("Bad value for bitLength.");var o=Math.floor((r+n-1)/8);if(r<0||o>=e.length)throw new Error("Index out of range.");var d=Math.floor(r/8);var f=r%8;while(n>0){1&t?e[d]|=1<<f:e[d]&=~(1<<f);t>>=1;n--;f=(f+1)%8;0===f&&d++}}function getSign(e){return e[e.length-1]>>>7}function highOrder(e,r){var n=r.length;var t=255*(1^e);while(n>0&&r[n-1]===t)n--;if(0===n)return-1;var o=r[n-1];var d=8*n-1;for(var f=7;f>0;f--){if((o>>f&1)===e)break;d--}return d}var t={};var o=r.Buffer;Object.defineProperty(t,"__esModule",{value:true});t.alloc=alloc;t.free=free;t.resize=resize;t.readInt=readInt;t.readUInt=readUInt;t.writeInt64=writeInt64;t.writeUInt64=writeUInt64;var d=[];var f=20;var a=-0x8000000000000000;var u=0x7ffffffffffffc00;var c=0xfffffffffffff800;var i=4294967296;var v=0x10000000000000000;function lowestBit(e){return e&-e}function isLossyToAdd(e,r){if(0===r)return false;var n=lowestBit(r);var t=e+n;return t===e||t-n!==e}function alloc(e){var r=d[e];r?d[e]=void 0:r=new o(e);r.fill(0);return r}function free(e){var r=e.length;r<f&&(d[r]=e)}function resize(e,r){if(r===e.length)return e;var n=alloc(r);e.copy(n);free(e);return n}function readInt(e){var r=e.length;var n=e[r-1]<128;var t=n?0:-1;var o=false;if(r<7)for(var d=r-1;d>=0;d--)t=256*t+e[d];else for(var f=r-1;f>=0;f--){var a=e[f];t*=256;isLossyToAdd(t,a)&&(o=true);t+=a}return{value:t,lossy:o}}function readUInt(e){var r=e.length;var n=0;var t=false;if(r<7)for(var o=r-1;o>=0;o--)n=256*n+e[o];else for(var d=r-1;d>=0;d--){var f=e[d];n*=256;isLossyToAdd(n,f)&&(t=true);n+=f}return{value:n,lossy:t}}function writeInt64(e,r){if(e<a||e>u)throw new Error("Value out of range.");e<0&&(e+=v);writeUInt64(e,r)}function writeUInt64(e,r){if(e<0||e>c)throw new Error("Value out of range.");var n=e%i;var t=Math.floor(e/i);r.writeUInt32LE(n,0);r.writeUInt32LE(t,4)}var l={};Object.defineProperty(l,"__esModule",{value:true});l.default=void 0;var I=_interopRequireDefault(e);var U=_interopRequireWildcard(n);var s=_interopRequireWildcard(t);function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};t.get||t.set?Object.defineProperty(r,n,t):r[n]=e[n]}r.default=e;return r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var B=-2147483648;var _=2147483647;var g=4294967295;function signedBitCount(e){return U.highOrder(1^U.getSign(e),e)+2}function unsignedBitCount(e){var r=U.highOrder(1,e)+1;return r||1}function encodeBufferCommon(e,r){var n;var t;if(r){n=U.getSign(e);t=signedBitCount(e)}else{n=0;t=unsignedBitCount(e)}var o=Math.ceil(t/7);var d=s.alloc(o);for(var f=0;f<o;f++){var a=U.extract(e,7*f,7,n);d[f]=128|a}d[o-1]&=127;return d}function encodedLength(e,r){var n=0;while(e[r+n]>=128)n++;n++;r+n>e.length;return n}function decodeBufferCommon(e,r,n){r=void 0===r?0:r;var t=encodedLength(e,r);var o=7*t;var d=Math.ceil(o/8);var f=s.alloc(d);var a=0;while(t>0){U.inject(f,a,7,e[r]);a+=7;r++;t--}var u;var c;if(n){var i=f[d-1];var v=a%8;if(0!==v){var l=32-v;i=f[d-1]=i<<l>>l&255}u=i>>7;c=255*u}else{u=0;c=0}while(d>1&&f[d-1]===c&&(!n||f[d-2]>>7===u))d--;f=s.resize(f,d);return{value:f,nextIndex:r}}function encodeIntBuffer(e){return encodeBufferCommon(e,true)}function decodeIntBuffer(e,r){return decodeBufferCommon(e,r,true)}function encodeInt32(e){var r=s.alloc(4);r.writeInt32LE(e,0);var n=encodeIntBuffer(r);s.free(r);return n}function decodeInt32(e,r){var n=decodeIntBuffer(e,r);var t=s.readInt(n.value);var o=t.value;s.free(n.value);if(o<B||o>_)throw new Error("integer too large");return{value:o,nextIndex:n.nextIndex}}function encodeInt64(e){var r=s.alloc(8);s.writeInt64(e,r);var n=encodeIntBuffer(r);s.free(r);return n}function decodeInt64(e,r){var n=decodeIntBuffer(e,r);var t=I.default.fromBytesLE(n.value,false);s.free(n.value);return{value:t,nextIndex:n.nextIndex,lossy:false}}function encodeUIntBuffer(e){return encodeBufferCommon(e,false)}function decodeUIntBuffer(e,r){return decodeBufferCommon(e,r,false)}function encodeUInt32(e){var r=s.alloc(4);r.writeUInt32LE(e,0);var n=encodeUIntBuffer(r);s.free(r);return n}function decodeUInt32(e,r){var n=decodeUIntBuffer(e,r);var t=s.readUInt(n.value);var o=t.value;s.free(n.value);if(o>g)throw new Error("integer too large");return{value:o,nextIndex:n.nextIndex}}function encodeUInt64(e){var r=s.alloc(8);s.writeUInt64(e,r);var n=encodeUIntBuffer(r);s.free(r);return n}function decodeUInt64(e,r){var n=decodeUIntBuffer(e,r);var t=I.default.fromBytesLE(n.value,true);s.free(n.value);return{value:t,nextIndex:n.nextIndex,lossy:false}}var h={decodeInt32:decodeInt32,decodeInt64:decodeInt64,decodeIntBuffer:decodeIntBuffer,decodeUInt32:decodeUInt32,decodeUInt64:decodeUInt64,decodeUIntBuffer:decodeUIntBuffer,encodeInt32:encodeInt32,encodeInt64:encodeInt64,encodeIntBuffer:encodeIntBuffer,encodeUInt32:encodeUInt32,encodeUInt64:encodeUInt64,encodeUIntBuffer:encodeUIntBuffer};l.default=h;var w={};Object.defineProperty(w,"__esModule",{value:true});w.decodeInt64=decodeInt64$1;w.decodeUInt64=decodeUInt64$1;w.decodeInt32=decodeInt32$1;w.decodeUInt32=decodeUInt32$1;w.encodeU32=encodeU32;w.encodeI32=encodeI32;w.encodeI64=encodeI64;w.MAX_NUMBER_OF_BYTE_U64=w.MAX_NUMBER_OF_BYTE_U32=void 0;var M=_interopRequireDefault$1(l);function _interopRequireDefault$1(e){return e&&e.__esModule?e:{default:e}}var x=5;w.MAX_NUMBER_OF_BYTE_U32=x;var E=10;w.MAX_NUMBER_OF_BYTE_U64=E;function decodeInt64$1(e,r){return M.default.decodeInt64(e,r)}function decodeUInt64$1(e,r){return M.default.decodeUInt64(e,r)}function decodeInt32$1(e,r){return M.default.decodeInt32(e,r)}function decodeUInt32$1(e,r){return M.default.decodeUInt32(e,r)}function encodeU32(e){return M.default.encodeUInt32(e)}function encodeI32(e){return M.default.encodeInt32(e)}function encodeI64(e){return M.default.encodeInt64(e)}const p=w.__esModule;const O=w.decodeInt64,y=w.decodeUInt64,m=w.decodeInt32,R=w.decodeUInt32,b=w.encodeU32,j=w.encodeI32,L=w.encodeI64,A=w.MAX_NUMBER_OF_BYTE_U64,T=w.MAX_NUMBER_OF_BYTE_U32;export default w;export{T as MAX_NUMBER_OF_BYTE_U32,A as MAX_NUMBER_OF_BYTE_U64,p as __esModule,m as decodeInt32,O as decodeInt64,R as decodeUInt32,y as decodeUInt64,j as encodeI32,L as encodeI64,b as encodeU32};

