import e from"once";import r from"process";var n={};var o=r;var t=e;var noop=function(){};var isRequest=function(e){return e.setHeader&&"function"===typeof e.abort};var isChildProcess=function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length};var eos=function(e,r,n){if("function"===typeof r)return eos(e,null,r);r||(r={});n=t(n||noop);var a=e._writableState;var i=e._readableState;var l=r.readable||false!==r.readable&&e.readable;var s=r.writable||false!==r.writable&&e.writable;var f=false;var onlegacyfinish=function(){e.writable||onfinish()};var onfinish=function(){s=false;l||n.call(e)};var onend=function(){l=false;s||n.call(e)};var onexit=function(r){n.call(e,r?new Error("exited with error code: "+r):null)};var onerror=function(r){n.call(e,r)};var onclose=function(){o.nextTick(onclosenexttick)};var onclosenexttick=function(){if(!f)return(!l||i&&i.ended&&!i.destroyed)&&(!s||a&&a.ended&&!a.destroyed)?void 0:n.call(e,new Error("premature close"))};var onrequest=function(){e.req.on("finish",onfinish)};if(isRequest(e)){e.on("complete",onfinish);e.on("abort",onclose);e.req?onrequest():e.on("request",onrequest)}else if(s&&!a){e.on("end",onlegacyfinish);e.on("close",onlegacyfinish)}isChildProcess(e)&&e.on("exit",onexit);e.on("end",onend);e.on("finish",onfinish);false!==r.error&&e.on("error",onerror);e.on("close",onclose);return function(){f=true;e.removeListener("complete",onfinish);e.removeListener("abort",onclose);e.removeListener("request",onrequest);e.req&&e.req.removeListener("finish",onfinish);e.removeListener("end",onlegacyfinish);e.removeListener("close",onlegacyfinish);e.removeListener("finish",onfinish);e.removeListener("exit",onexit);e.removeListener("end",onend);e.removeListener("error",onerror);e.removeListener("close",onclose)}};n=eos;var a=n;export default a;

