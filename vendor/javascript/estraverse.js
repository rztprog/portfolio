var e={name:"estraverse",description:"ECMAScript JS AST traversal functions",homepage:"https://github.com/estools/estraverse",main:"estraverse.js",version:"4.3.0",engines:{node:">=4.0"},maintainers:[{name:"Yusuke Suzuki",email:"utatane.tea@gmail.com",web:"http://github.com/Constellation"}],repository:{type:"git",url:"http://github.com/estools/estraverse.git"},devDependencies:{"babel-preset-env":"^1.6.1","babel-register":"^6.3.13",chai:"^2.1.1",espree:"^1.11.0",gulp:"^3.8.10","gulp-bump":"^0.2.2","gulp-filter":"^2.0.0","gulp-git":"^1.0.1","gulp-tag-version":"^1.3.0",jshint:"^2.5.6",mocha:"^2.1.0"},license:"BSD-2-Clause",scripts:{test:"npm run-script lint && npm run-script unit-test",lint:"jshint estraverse.js","unit-test":"mocha --compilers js:babel-register"}};var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var r={};(function clone(r){var n,i,o,a,s,l;function deepCopy(e){var t={},r,n;for(r in e)if(e.hasOwnProperty(r)){n=e[r];t[r]="object"===typeof n&&null!==n?deepCopy(n):n}return t}function upperBound(e,t){var r,n,i,o;n=e.length;i=0;while(n){r=n>>>1;o=i+r;if(t(e[o]))n=r;else{i=o+1;n-=r+1}}return i}n={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"};o={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],Program:["body"],Property:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]};a={};s={};l={};i={Break:a,Skip:s,Remove:l};function Reference(e,r){(this||t).parent=e;(this||t).key=r}Reference.prototype.replace=function replace(e){(this||t).parent[(this||t).key]=e};Reference.prototype.remove=function remove(){if(Array.isArray((this||t).parent)){(this||t).parent.splice((this||t).key,1);return true}this.replace(null);return false};function Element(e,r,n,i){(this||t).node=e;(this||t).path=r;(this||t).wrap=n;(this||t).ref=i}function Controller(){}Controller.prototype.path=function path(){var e,r,n,i,o,a;function addToPath(e,t){if(Array.isArray(t))for(n=0,i=t.length;n<i;++n)e.push(t[n]);else e.push(t)}if(!(this||t).__current.path)return null;o=[];for(e=2,r=(this||t).__leavelist.length;e<r;++e){a=(this||t).__leavelist[e];addToPath(o,a.path)}addToPath(o,(this||t).__current.path);return o};Controller.prototype.type=function(){var e=this.current();return e.type||(this||t).__current.wrap};Controller.prototype.parents=function parents(){var e,r,n;n=[];for(e=1,r=(this||t).__leavelist.length;e<r;++e)n.push((this||t).__leavelist[e].node);return n};Controller.prototype.current=function current(){return(this||t).__current.node};Controller.prototype.__execute=function __execute(e,r){var n,i;i=void 0;n=(this||t).__current;(this||t).__current=r;(this||t).__state=null;e&&(i=e.call(this||t,r.node,(this||t).__leavelist[(this||t).__leavelist.length-1].node));(this||t).__current=n;return i};Controller.prototype.notify=function notify(e){(this||t).__state=e};Controller.prototype.skip=function(){this.notify(s)};Controller.prototype["break"]=function(){this.notify(a)};Controller.prototype.remove=function(){this.notify(l)};Controller.prototype.__initialize=function(e,r){(this||t).visitor=r;(this||t).root=e;(this||t).__worklist=[];(this||t).__leavelist=[];(this||t).__current=null;(this||t).__state=null;(this||t).__fallback=null;"iteration"===r.fallback?(this||t).__fallback=Object.keys:"function"===typeof r.fallback&&((this||t).__fallback=r.fallback);(this||t).__keys=o;r.keys&&((this||t).__keys=Object.assign(Object.create((this||t).__keys),r.keys))};function isNode(e){return null!=e&&("object"===typeof e&&"string"===typeof e.type)}function isProperty(e,t){return(e===n.ObjectExpression||e===n.ObjectPattern)&&"properties"===t}Controller.prototype.traverse=function traverse(e,r){var n,i,o,l,p,c,u,m,h,f,d,g;this.__initialize(e,r);g={};n=(this||t).__worklist;i=(this||t).__leavelist;n.push(new Element(e,null,null,null));i.push(new Element(null,null,null,null));while(n.length){o=n.pop();if(o!==g){if(o.node){c=this.__execute(r.enter,o);if((this||t).__state===a||c===a)return;n.push(g);i.push(o);if((this||t).__state===s||c===s)continue;l=o.node;p=l.type||o.wrap;f=(this||t).__keys[p];if(!f){if(!(this||t).__fallback)throw new Error("Unknown node type "+p+".");f=this.__fallback(l)}m=f.length;while((m-=1)>=0){u=f[m];d=l[u];if(d)if(Array.isArray(d)){h=d.length;while((h-=1)>=0)if(d[h]){if(isProperty(p,f[m]))o=new Element(d[h],[u,h],"Property",null);else{if(!isNode(d[h]))continue;o=new Element(d[h],[u,h],null,null)}n.push(o)}}else isNode(d)&&n.push(new Element(d,u,null,null))}}}else{o=i.pop();c=this.__execute(r.leave,o);if((this||t).__state===a||c===a)return}}};Controller.prototype.replace=function replace(e,r){var n,i,o,p,c,u,m,h,f,d,g,y,E;function removeElem(e){var t,r,i,o;if(e.ref.remove()){r=e.ref.key;o=e.ref.parent;t=n.length;while(t--){i=n[t];if(i.ref&&i.ref.parent===o){if(i.ref.key<r)break;--i.ref.key}}}}this.__initialize(e,r);g={};n=(this||t).__worklist;i=(this||t).__leavelist;y={root:e};u=new Element(e,null,null,new Reference(y,"root"));n.push(u);i.push(u);while(n.length){u=n.pop();if(u!==g){c=this.__execute(r.enter,u);if(void 0!==c&&c!==a&&c!==s&&c!==l){u.ref.replace(c);u.node=c}if((this||t).__state===l||c===l){removeElem(u);u.node=null}if((this||t).__state===a||c===a)return y.root;o=u.node;if(o){n.push(g);i.push(u);if((this||t).__state!==s&&c!==s){p=o.type||u.wrap;f=(this||t).__keys[p];if(!f){if(!(this||t).__fallback)throw new Error("Unknown node type "+p+".");f=this.__fallback(o)}m=f.length;while((m-=1)>=0){E=f[m];d=o[E];if(d)if(Array.isArray(d)){h=d.length;while((h-=1)>=0)if(d[h]){if(isProperty(p,f[m]))u=new Element(d[h],[E,h],"Property",new Reference(d,h));else{if(!isNode(d[h]))continue;u=new Element(d[h],[E,h],null,new Reference(d,h))}n.push(u)}}else isNode(d)&&n.push(new Element(d,E,null,new Reference(o,E)))}}}}else{u=i.pop();c=this.__execute(r.leave,u);void 0!==c&&c!==a&&c!==s&&c!==l&&u.ref.replace(c);(this||t).__state!==l&&c!==l||removeElem(u);if((this||t).__state===a||c===a)return y.root}}return y.root};function traverse(e,t){var r=new Controller;return r.traverse(e,t)}function replace(e,t){var r=new Controller;return r.replace(e,t)}function extendCommentRange(e,t){var r;r=upperBound(t,(function search(t){return t.range[0]>e.range[0]}));e.extendedRange=[e.range[0],e.range[1]];r!==t.length&&(e.extendedRange[1]=t[r].range[0]);r-=1;r>=0&&(e.extendedRange[0]=t[r].range[1]);return e}function attachComments(e,t,r){var n=[],o,a,s,l;if(!e.range)throw new Error("attachComments needs range information");if(!r.length){if(t.length){for(s=0,a=t.length;s<a;s+=1){o=deepCopy(t[s]);o.extendedRange=[0,e.range[0]];n.push(o)}e.leadingComments=n}return e}for(s=0,a=t.length;s<a;s+=1)n.push(extendCommentRange(deepCopy(t[s]),r));l=0;traverse(e,{enter:function(e){var t;while(l<n.length){t=n[l];if(t.extendedRange[1]>e.range[0])break;if(t.extendedRange[1]===e.range[0]){e.leadingComments||(e.leadingComments=[]);e.leadingComments.push(t);n.splice(l,1)}else l+=1}return l===n.length?i.Break:n[l].extendedRange[0]>e.range[1]?i.Skip:void 0}});l=0;traverse(e,{leave:function(e){var t;while(l<n.length){t=n[l];if(e.range[1]<t.extendedRange[0])break;if(e.range[1]===t.extendedRange[0]){e.trailingComments||(e.trailingComments=[]);e.trailingComments.push(t);n.splice(l,1)}else l+=1}return l===n.length?i.Break:n[l].extendedRange[0]>e.range[1]?i.Skip:void 0}});return e}r.version=e.version;r.Syntax=n;r.traverse=traverse;r.replace=replace;r.attachComments=attachComments;r.VisitorKeys=o;r.VisitorOption=i;r.Controller=Controller;r.cloneEnvironment=function(){return clone({})};return r})(r);const n=r.version,i=r.Syntax,o=r.traverse,a=r.replace,s=r.attachComments,l=r.VisitorKeys,p=r.VisitorOption,c=r.Controller,u=r.cloneEnvironment;export default r;export{c as Controller,i as Syntax,l as VisitorKeys,p as VisitorOption,s as attachComments,u as cloneEnvironment,a as replace,o as traverse,n as version};

